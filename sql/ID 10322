select a.user_id
from(
select *
from amazon_transactions

) as a
join (
select *
from amazon_transactions

) as b 
on a.user_id = b.user_id 
and a.id <> b.id
and a.created_at between b.created_at - 7 and b.created_at
group by 1
